;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; 候補選択型インタフェース──Anything
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; (auto-install-batch "anything")
;;(require 'anything-startup)

(when (require 'anything nil t)
  (define-key global-map (kbd "C-;") 'anything)
  
  (setq
   ;; 候補を表示するまでの時間。デフォルトは0.5
   anything-idle-delay 0.3
   ;; タイプして再描写するまでの時間。デフォルトは0.1
   anything-input-idle-delay 0.5
   ;; 候補の最大表示数。デフォルトは50
   ;; anything-candidate-number-limit 100
   ;; 候補が多いときに体感速度を早くする
   ;;anything-quick-update t
   ;; 候補選択ショートカットをアルファベットに
   ;; anything-enable-shortcuts 'alphabet
   anything-enable-shortcuts 't
   )

  (when (require 'anything-config nil t)
    ;; root権限でアクションを実行するときのコマンド
    ;; デフォルトは"su"
    (setq anything-su-or-sudo "sudo"))

  (require 'anything-match-plugin nil t)

  (when (and (executable-find "cmigemo")
             (require 'migemo nil t))
    (require 'anything-migemo nil t))

  (when (require 'anything-complete nil t)
    ;; lispシンボルの補完候補の再検索時間
    (anything-lisp-complete-symbol-set-timer 150))

  (require 'anything-show-completion nil t)

  (when (require 'auto-install nil t)
    (require 'anything-auto-install nil t))

  (when (require 'descbinds-anything nil t)
    ;; describe-bindingsをAnythingに置き換える
    (descbinds-anything-install)))


;;; 過去の履歴からペースト──anything-show-kill-ring
;; M-yにanything-show-kill-ringを割り当てる
(define-key global-map (kbd "M-y") 'anything-show-kill-ring)

;; ;;; moccurを利用する──anything-c-moccur
(when (require 'anything-c-moccur nil t)
  (setq
   ;; anything-c-moccur用 `anything-idle-delay'
   anything-c-moccur-anything-idle-delay 0.1
   ;; バッファの情報をハイライトする
   anything-c-moccur-higligt-info-line-flag t
   ;; 現在選択中の候補の位置をほかのwindowに表示する
   anything-c-moccur-enable-auto-look-flag t
   ;; 起動時にポイントの位置の単語を初期パターンにする
   anything-c-moccur-enable-initial-pattern t)

  ;; キーバインドの割当(好みに合わせて設定してください)
  (global-set-key (kbd "M-o") 'anything-c-moccur-occur-by-moccur)
  (global-set-key (kbd "C-M-o") 'anything-c-moccur-dmoccur)
  (add-hook 'dired-mode-hook
            '(lambda ()
               (local-set-key (kbd "O") 'anything-c-moccur-dired-do-moccur-by-moccur)))
  (global-set-key (kbd "C-M-s") 'anything-c-moccur-isearch-forward)
  (global-set-key (kbd "C-M-r") 'anything-c-moccur-isearch-backward)

  (define-key anything-c-moccur-anything-map (kbd "<down>")  'anything-c-moccur-next-line)
  (define-key anything-c-moccur-anything-map (kbd "<up>")  'anything-c-moccur-previous-line)
)

;;;
;;; anything-bookmarksを利用する。
;;;
(define-key global-map "\C-xrl" 'anything-bookmarks)
